<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Translate API Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        button {
            background-color: #00A99D;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        button:hover {
            background-color: #007A70;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .suggestions {
            margin-top: 20px;
        }
        .suggestion-item {
            background-color: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #00A99D;
        }
        .english-text {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .translated-text {
            color: #00A99D;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .speak-button {
            background-color: #4285F4;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .speak-button:hover {
            background-color: #3367D6;
        }
        .api-key-section {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }
        .api-key-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Google Translate API Integration Test</h1>
        
        <div class="api-key-section">
            <h3>üîë API Key Setup</h3>
            <p>Enter your Google Translate API key below:</p>
            <input type="text" id="apiKey" class="api-key-input" placeholder="Enter your Google Translate API key here...">
            <p><small>Get your API key from <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></small></p>
        </div>

        <div class="form-group">
            <label for="userQuery">Scenario Description:</label>
            <textarea 
                id="userQuery" 
                placeholder="Describe a library scenario (e.g., 'customer wants to borrow a book', 'someone needs help with computer', 'person asking about library card')"
            ></textarea>
        </div>

        <div class="form-group">
            <label for="targetLanguage">Target Language:</label>
            <select id="targetLanguage">
                <option value="Mandarin">Mandarin (ÊôÆÈÄöËØù)</option>
                <option value="Cantonese">Cantonese (Á≤§ËØ≠)</option>
                <option value="Nepali">Nepali (‡§®‡•á‡§™‡§æ‡§≤‡•Ä)</option>
                <option value="Greek">Greek (ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨)</option>
                <option value="Arabic">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
                <option value="Macedonian">Macedonian (–ú–∞–∫–µ–¥–æ–Ω—Å–∫–∏)</option>
                <option value="Spanish">Spanish (Espa√±ol)</option>
                <option value="Italian">Italian (Italiano)</option>
                <option value="Indonesian">Indonesian (Bahasa Indonesia)</option>
            </select>
        </div>

        <button id="translateBtn" onclick="fetchSuggestions()">Get Translation Suggestions</button>

        <div id="loading" class="loading" style="display: none;">Translating...</div>
        <div id="error" class="error" style="display: none;"></div>
        <div id="suggestions" class="suggestions"></div>
    </div>

    <script>
        // Language codes mapping
        const LANGUAGE_CODES = {
            'Mandarin': { code: 'zh-CN', nativeName: 'ÊôÆÈÄöËØù' },
            'Cantonese': { code: 'zh-HK', nativeName: 'Á≤§ËØ≠' },
            'Nepali': { code: 'ne-NP', nativeName: '‡§®‡•á‡§™‡§æ‡§≤‡•Ä' },
            'Greek': { code: 'el-GR', nativeName: 'ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨' },
            'Arabic': { code: 'ar-SA', nativeName: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' },
            'Macedonian': { code: 'mk-MK', nativeName: '–ú–∞–∫–µ–¥–æ–Ω—Å–∫–∏' },
            'Spanish': { code: 'es-ES', nativeName: 'Espa√±ol' },
            'Italian': { code: 'it-IT', nativeName: 'Italiano' },
            'Indonesian': { code: 'id-ID', nativeName: 'Bahasa Indonesia' },
        };

        // Common library phrases
        const COMMON_LIBRARY_PHRASES = [
            "How can I help you?",
            "Do you need assistance?",
            "Let me show you how to use this.",
            "Would you like me to explain this?",
            "Is there anything else you need?",
            "Please wait a moment.",
            "I'll be right back.",
            "Can I help you find something?",
            "Do you have any questions?",
            "Let me check that for you.",
            "Would you like to borrow this item?",
            "Do you have a library card?",
            "Can I help you with the computer?",
            "Would you like to use the printer?",
            "Do you need help finding a book?",
            "Is there anything specific you're looking for?",
            "Let me help you with that.",
            "Would you like me to demonstrate this?",
            "Do you need help with your account?",
            "Can I assist you with anything else?"
        ];

        // Translate text using Google Translate API
        async function translateText(text, targetLanguage, apiKey) {
            try {
                const response = await fetch(`https://translation.googleapis.com/language/translate/v2?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        q: text,
                        target: targetLanguage,
                        source: 'en'
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                
                if (result.data && result.data.translations && result.data.translations.length > 0) {
                    return result.data.translations[0].translatedText;
                } else {
                    throw new Error('No translation data received');
                }
            } catch (error) {
                console.error('Translation error:', error);
                throw error;
            }
        }

        // Get relevant phrases based on user query
        function getRelevantPhrases(userQuery) {
            const query = userQuery.toLowerCase();
            
            const relevantPhrases = COMMON_LIBRARY_PHRASES.filter(phrase => {
                const phraseLower = phrase.toLowerCase();
                return phraseLower.includes(query) ||
                       query.includes(phraseLower) ||
                       phraseLower.includes('help') ||
                       phraseLower.includes('assist') ||
                       phraseLower.includes('need') ||
                       phraseLower.includes('want');
            });

            return relevantPhrases.length > 0 ? relevantPhrases.slice(0, 3) : COMMON_LIBRARY_PHRASES.slice(0, 3);
        }

        // Fetch suggested phrases
        async function fetchSuggestedPhrases(userQuery, targetLanguage, apiKey) {
            if (!userQuery.trim()) {
                return [];
            }

            try {
                const phrasesToTranslate = getRelevantPhrases(userQuery);
                const targetLangCode = LANGUAGE_CODES[targetLanguage]?.code || 'zh-CN';
                
                const translatedPhrases = [];

                for (const phrase of phrasesToTranslate) {
                    try {
                        const translatedText = await translateText(phrase, targetLangCode, apiKey);
                        translatedPhrases.push({
                            english: phrase,
                            translated: translatedText,
                            language: targetLanguage
                        });
                    } catch (error) {
                        console.error(`Error translating phrase "${phrase}":`, error);
                        translatedPhrases.push({
                            english: phrase,
                            translated: `[Translation for: ${phrase}]`,
                            language: targetLanguage
                        });
                    }
                }

                return translatedPhrases;
            } catch (error) {
                console.error('Error fetching suggested phrases:', error);
                return [{
                    english: "Error fetching suggestions.",
                    translated: "Ëé∑ÂèñÂª∫ËÆÆÊó∂Âá∫Èîô„ÄÇ",
                    language: targetLanguage
                }];
            }
        }

        // Main function to fetch suggestions
        async function fetchSuggestions() {
            const userQuery = document.getElementById('userQuery').value;
            const targetLanguage = document.getElementById('targetLanguage').value;
            const apiKey = document.getElementById('apiKey').value;

            if (!apiKey) {
                showError('Please enter your Google Translate API key first.');
                return;
            }

            if (!userQuery.trim()) {
                showError('Please enter a scenario description.');
                return;
            }

            // Show loading state
            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').style.display = 'none';
            document.getElementById('suggestions').innerHTML = '';

            try {
                const suggestions = await fetchSuggestedPhrases(userQuery, targetLanguage, apiKey);
                displaySuggestions(suggestions);
            } catch (error) {
                showError(`Error: ${error.message}`);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // Display suggestions
        function displaySuggestions(suggestions) {
            const suggestionsDiv = document.getElementById('suggestions');
            
            if (suggestions.length === 0) {
                suggestionsDiv.innerHTML = '<p>No suggestions found.</p>';
                return;
            }

            let html = '<h3>Translation Suggestions:</h3>';
            
            suggestions.forEach((suggestion, index) => {
                html += `
                    <div class="suggestion-item">
                        <div class="english-text">${suggestion.english}</div>
                        <div class="translated-text">${suggestion.translated}</div>
                        <button class="speak-button" onclick="speakText('${suggestion.translated}', '${LANGUAGE_CODES[suggestion.language].code}')">
                            üîä Speak
                        </button>
                    </div>
                `;
            });

            suggestionsDiv.innerHTML = html;
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        // Speak text using browser's speech synthesis
        function speakText(text, languageCode) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = languageCode;
                utterance.rate = 0.9;
                window.speechSynthesis.speak(utterance);
            } else {
                alert('Speech synthesis not supported in this browser.');
            }
        }

        // Allow Enter key to submit
        document.getElementById('userQuery').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                fetchSuggestions();
            }
        });
    </script>
</body>
</html> 